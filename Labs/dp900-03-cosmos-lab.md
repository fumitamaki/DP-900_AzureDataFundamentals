---
lab:
  title: Azure Cosmos DB を調べる
  module: Explore fundamentals of Azure Cosmos DB
---
# Azure Cosmos DB を調べる

この演習では、自分の Azure サブスクリプションで Azure Cosmos DB データベースをプロビジョニングし、それを使用して非リレーショナル データを格納するさまざまな方法を検討します。

このラボは完了するまで、約 **20** 分かかります。

## Cosmos DB アカウントを作成する

Cosmos DB を使うには、Azure サブスクリプションで Cosmos DB アカウントをプロビジョニングする必要があります。 この演習では、Azure Cosmos DB for NoSQL を使う Cosmos DB のアカウントをプロビジョニングします。

1. Azure portal で、左上の **[+ リソースの作成]** を選び、*Azure Cosmos DB* を検索します。  結果から **[Azure Cosmos DB]** を選択し、 **[作成]** を選択します。
1. **コア (SQL) - 推奨** のタイルで、 **[作成]** を選びます。
1. 次の詳細を入力して、**[レビュー + 作成]** を選択します。
    - **サブスクリプション**: 既定のサブスクリプションを使用（選択済み）
    - **リソース グループ**: **ResourceGroup1**（作成済み）
    - **アカウント名**: グローバルに一意の名前を入力
    - **場所**:  **(US) East US**
    - **容量モード**: プロビジョニングされたスループット
    - **Apply Free-Tier Discount (Free レベル割引を適用する)**: 使用できる場合は [適用] を選択
    - **合計アカウント スループットを制限する**: **オフ（チェックを外す）**
1. 構成を確認したら、**[作成]** を選びます。
1. デプロイが完了するまで待ちます。 次に、デプロイされたリソースに移動します。

## サンプル データベースの作成

"この手順全体を通して、ポータルに表示されるヒントはすべて閉じて問題ありません"

1. 新しい Cosmos DB アカウントのページの左側のペインで **[データ エクスプローラー]** を選びます。
1. **[データエクスプローラー]** ページで、**[Launch quick start]** を選びます。
1. 画面右側に表示される**[New Container]** タブで、サンプル データベースの事前に設定された値を確認して、**[OK]** を選びます。
1. **SampleDB** データベースとその **SampleContainer** コンテナーが作成されるまで少し待ちます (1 分ほどかかる場合があります)。

## 項目の表示と作成

1. [データエクスプローター] ページで **SampleDB** データベースと **SampleContainer** コンテナーを展開し、**[Item]** を選んでコンテナー内の項目の一覧を表示します。 項目は製品データを表し、それぞれに一意の ID と他のプロパティがあります。
1. 一覧内の項目を選ぶと、項目データの JSON 表現が表示されます。
1. ページの上部にある **[New Item]** を選び、新しい空白の項目を作成します。
1. 新しい項目の JSON を以下のように変更し、**[Save]** を選びます。

    ```json
    {
        "name": "Road Helmet,45",
        "id": "123456789",
        "categoryID": "123456789",
        "SKU": "AB-1234-56",
        "description": "The product called \"Road Helmet,45\" ",
        "price": 48.74
    }
    ```

1. 新しい項目を保存すると、追加のメタデータ プロパティが自動的に追加されます。

## データベースのクエリを実行する

1. **[データエクスプローラー]** ページで、**[New SQL Query]** アイコン（表が重なっているようなアイコン）を選びます。
1. SQL クエリ エディターで既定のクエリ (`SELECT * FROM c`) を確認し、**Execute Query** ボタンを使って実行します。
1. すべての項目の完全な JSON 表現を含む結果を確認します。
1. 次のように、クエリを変更します。

    ```sql
    SELECT *
    FROM c
    WHERE CONTAINS(c.name,"Helmet")
    ```

1. **[Execute Query]** ボタンを使って、修正したクエリを実行し、結果を確認します。これには、**name** フィールドに "Helmet" というテキストが含まれる項目の JSON エンティティが含まれます。
1. SQL クエリ エディターを閉じ、変更内容を破棄します。

    ここでは、Azure portal の Data Explorer インターフェイスを使って、Cosmos DB データベースで JSON エンティティを作成し、クエリを実行する方法について確認しました。 実際のシナリオでは、アプリケーション開発者は、数多くあるプログラミング言語固有のソフトウェア開発キット (SDK) のいずれかを使って NoSQL API を呼び出し、データベース内のデータを操作します。
